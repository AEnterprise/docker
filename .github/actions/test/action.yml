name: 'Run tests'
description: 'Builds the Docker image and runs goss tests'
runs:
  using: 'composite'
  steps:
    - name: Install goss and dgoss
      uses: e1himself/goss-installation-action@v1.0.4
      with:
        version: 'v0.3.16'
    - name: Build the Docker image
      uses: docker/build-push-action@v3.2.0
      with:
        push: false
        tags: phanan/koel:test
    - name: Run goss tests on the image
      shell: bash
      run: dgoss run phanan/koel:test
